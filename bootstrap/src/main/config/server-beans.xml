<?xml version="1.0" encoding="UTF-8"?>
<deployment xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="urn:jboss:bean-deployer:2.0 bean-deployer_2_0.xsd"
	xmlns="urn:jboss:bean-deployer:2.0">

	<!-- System clock -->
	<bean name="SystemClock" class="org.mobicents.media.server.scheduler.WallClock" />

	<!-- EDF scheduler -->
	<bean name="Scheduler"
		class="org.mobicents.media.server.scheduler.PriorityQueueScheduler">
		<property name="clock">
			<inject bean="SystemClock" />
		</property>
	</bean>

	<bean name="ServiceScheduler" class="org.mobicents.media.server.scheduler.ServiceScheduler" />

	<!-- Network interfaces definition -->
	<bean name="localhost" class="org.mobicents.media.server.io.network.UdpManager">
		<constructor>
			<parameter>
				<inject bean="ServiceScheduler" />
			</parameter>
		</constructor>
		<property name="bindAddress">127.0.0.1</property>
		<property name="localBindAddress">127.0.0.1</property>
		<property name="externalAddress"><null /></property>
		<property name="localNetwork">127.0.0.1</property>
		<property name="localSubnet">255.255.255.255</property>
		<property name="useSbc">false</property>
		<property name="rtpTimeout">0</property>
		<property name="lowestPort">34534</property>
		<property name="highestPort">65535</property>
	</bean>

	<!-- SS7 interface definition -->
	<!--<bean name="SS7" class="org.mobicents.media.server.io.ss7.SS7Manager"> 
		<constructor> <parameter><inject bean="Scheduler"/></parameter> </constructor> 
		</bean> -->

	<!-- Channels manager definition -->
	<bean name="channelsManager" class="org.mobicents.media.server.impl.rtp.ChannelsManager">
		<constructor>
			<parameter>
				<inject bean="localhost" />
			</parameter>
		</constructor>
		<property name="scheduler">
			<inject bean="Scheduler" />
		</property>
		<property name="jitterBufferSize">50</property>
		<!--<property name="SS7Manager"><inject bean="SS7" /></property> -->
	</bean>

	<!-- Signal processor factory -->
	<bean name="DSP" class="org.mobicents.media.server.component.DspFactoryImpl">
		<property name="codecs">
			<list value-type="java.lang.String">
				<value>org.mobicents.media.server.impl.dsp.audio.l16.Encoder</value>
				<value>org.mobicents.media.server.impl.dsp.audio.l16.Decoder</value>
				<value>org.mobicents.media.server.impl.dsp.audio.g711.alaw.Encoder</value>
				<value>org.mobicents.media.server.impl.dsp.audio.g711.alaw.Decoder</value>
				<value>org.mobicents.media.server.impl.dsp.audio.g711.ulaw.Encoder</value>
				<value>org.mobicents.media.server.impl.dsp.audio.g711.ulaw.Decoder</value>
				<value>org.mobicents.media.server.impl.dsp.audio.gsm.Encoder</value>
				<value>org.mobicents.media.server.impl.dsp.audio.gsm.Decoder</value>
			</list>
		</property>
	</bean>
	
	<!-- Resource Factories -->
	<bean name="remoteConnectionFactory" class="org.mobicents.media.core.connections.RtpConnectionFactory">
		<constructor>
			<parameter><inject bean="channelsManager" /></parameter>
			<parameter><inject bean="DSP" /></parameter>
		</constructor>
	</bean>

	<bean name="localConnectionFactory" class="org.mobicents.media.core.connections.LocalConnectionFactory">
		<constructor>
			<parameter><inject bean="channelsManager" /></parameter>
		</constructor>
	</bean>

	<bean name="playerFactory" class="org.mobicents.media.server.impl.resource.mediaplayer.audio.AudioPlayerFactory">
		<constructor>
			<parameter><inject bean="Scheduler" /></parameter>
			<parameter><inject bean="DSP" /></parameter>
		</constructor>
	</bean>

	<bean name="recorderFactory" class="org.mobicents.media.server.impl.resource.audio.AudioRecorderFactory">
		<constructor>
			<parameter><inject bean="Scheduler" /></parameter>
		</constructor>
	</bean>

	<bean name="dtmfDetectorFactory" class="org.mobicents.media.server.impl.resource.dtmf.DtmfDetectorFactory">
		<constructor>
			<parameter><inject bean="Scheduler" /></parameter>
			<parameter>-35</parameter>
		</constructor>
	</bean>

	<bean name="dtmfGeneratorFactory" class="org.mobicents.media.server.impl.resource.dtmf.DtmfGeneratorFactory">
		<constructor>
			<parameter><inject bean="Scheduler" /></parameter>
			<parameter>-20</parameter>
			<parameter>80</parameter>
		</constructor>
	</bean>

	<bean name="signalDetectorFactory" class="org.mobicents.media.server.impl.resource.phone.PhoneSignalDetectorFactory">
		<constructor>
			<parameter><inject bean="Scheduler" /></parameter>
		</constructor>
	</bean>

	<bean name="signalGeneratorFactory" class="org.mobicents.media.server.impl.resource.phone.PhoneSignalGeneratorFactory">
		<constructor>
			<parameter><inject bean="Scheduler" /></parameter>
		</constructor>
	</bean>

	<!-- Resource Pools -->
	<bean name="remoteConnectionPool" class="org.mobicents.media.core.connections.RtpConnectionPool">
		<constructor>
			<parameter>50</parameter>
			<parameter>
				<inject bean="remoteConnectionFactory" />
			</parameter>
		</constructor>
	</bean>

	<bean name="localConnectionPool" class="org.mobicents.media.core.connections.LocalConnectionPool">
		<constructor>
			<parameter>100</parameter>
			<parameter>
				<inject bean="localConnectionFactory" />
			</parameter>
		</constructor>
	</bean>

	<bean name="playerPool" class="org.mobicents.media.server.impl.resource.mediaplayer.audio.AudioPlayerPool">
		<constructor>
			<parameter>50</parameter>
			<parameter>
				<inject bean="playerFactory" />
			</parameter>
		</constructor>
	</bean>

	<bean name="recorderPool" class="org.mobicents.media.server.impl.resource.audio.AudioRecorderPool">
		<constructor>
			<parameter>50</parameter>
			<parameter>
				<inject bean="recorderFactory" />
			</parameter>
		</constructor>
	</bean>

	<bean name="dtmfDetectorPool" class="org.mobicents.media.server.impl.resource.dtmf.DtmfDetectorPool">
		<constructor>
			<parameter>50</parameter>
			<parameter>
				<inject bean="dtmfDetectorFactory" />
			</parameter>
		</constructor>
	</bean>

	<bean name="dtmfGeneratorPool" class="org.mobicents.media.server.impl.resource.dtmf.DtmfGeneratorPool">
		<constructor>
			<parameter>50</parameter>
			<parameter>
				<inject bean="dtmfGeneratorFactory" />
			</parameter>
		</constructor>
	</bean>

	<bean name="signalDetectorPool" class="org.mobicents.media.server.impl.resource.phone.PhoneSignalDetectorPool">
		<constructor>
			<parameter>50</parameter>
			<parameter>
				<inject bean="signalDetectorFactory" />
			</parameter>
		</constructor>
	</bean>

	<bean name="signalGeneratorPool" class="org.mobicents.media.server.impl.resource.phone.PhoneSignalGeneratorPool">
		<constructor>
			<parameter>50</parameter>
			<parameter>
				<inject bean="signalGeneratorFactory" />
			</parameter>
		</constructor>
	</bean>
	
	<bean name="resourcesPool" class="org.mobicents.media.core.ResourcesPool">
		<constructor>
			<parameter><inject bean="remoteConnectionPool" /></parameter>
			<parameter><inject bean="localConnectionPool" /></parameter>
			<parameter><inject bean="playerPool" /></parameter>
			<parameter><inject bean="recorderPool" /></parameter>
			<parameter><inject bean="dtmfDetectorPool" /></parameter>
			<parameter><inject bean="dtmfGeneratorPool" /></parameter>
			<parameter><inject bean="signalDetectorPool" /></parameter>
			<parameter><inject bean="signalGeneratorPool" /></parameter>
		</constructor>
	</bean>

	<!-- MGCP Controller definition -->
	<bean name="MGCP" class="org.mobicents.media.server.mgcp.controller.Controller">
		<property name="udpInterface">
			<inject bean="localhost" />
		</property>
		<property name="port">2427</property>
		<property name="mediaScheduler">
			<inject bean="Scheduler" />
		</property>
		<property name="taskScheduler">
			<inject bean="ServiceScheduler" />
		</property>
		<property name="server">
			<inject bean="MediaServer" />
		</property>
		<property name="configuration">mgcp-conf.xml</property>
		<property name="poolSize">25</property>
	</bean>

	<!-- Media Server -->
	<bean name="MediaServer" class="org.mobicents.media.core.Server">
		<property name="clock">
			<inject bean="SystemClock" />
		</property>
		<property name="scheduler">
			<inject bean="Scheduler" />
		</property>
		<property name="udpManager">
			<inject bean="localhost" />
		</property>
		<property name="resourcesPool">
			<inject bean="resourcesPool" />
		</property>
		<property name="heartBeatTime">1</property>
		<incallback method="addInstaller" />
		<uncallback method="removeInstaller" />
	</bean>

	<!-- Endpoints -->
	<!-- 
	<bean name="Announcement"
		class="org.mobicents.media.core.endpoints.VirtualEndpointInstaller">
		<property name="namePattern">mobicents/aap/</property>
		<property name="endpointClass">org.mobicents.media.core.endpoints.impl.AnnouncementEndpoint</property>
		<property name="initialSize">1</property>
	</bean>
	 -->

	<bean name="IVR"
		class="org.mobicents.media.core.endpoints.VirtualEndpointInstaller">
		<property name="namePattern">mobicents/ivr/</property>
		<property name="endpointClass">org.mobicents.media.core.endpoints.impl.IvrEndpoint</property>
		<property name="initialSize">50</property>
	</bean>

	<bean name="CNF"
		class="org.mobicents.media.core.endpoints.VirtualEndpointInstaller">
		<property name="namePattern">mobicents/cnf/</property>
		<property name="endpointClass">org.mobicents.media.core.endpoints.impl.ConferenceEndpoint</property>
		<property name="initialSize">50</property>
	</bean>

	<bean name="Bridge"
		class="org.mobicents.media.core.endpoints.VirtualEndpointInstaller">
		<property name="namePattern">mobicents/bridge/</property>
		<property name="endpointClass">org.mobicents.media.core.endpoints.impl.BridgeEndpoint</property>
		<property name="initialSize">50</property>
	</bean>

	<!-- 
	<bean name="Relay"
		class="org.mobicents.media.core.endpoints.VirtualEndpointInstaller">
		<property name="namePattern">mobicents/relay/</property>
		<property name="endpointClass">org.mobicents.media.core.endpoints.impl.PacketRelayEndpoint</property>
		<property name="initialSize">1</property>
	</bean>
	 -->
 
	<!-- DS0 Endpoints configuration sample -->
	<!-- 
	<bean name="DS0"
		class="org.mobicents.media.core.endpoints.VirtualSS7EndpointInstaller">
		<property name="namePattern">mobicents/ds0/</property>
		<property name="channelsManager">
			<inject bean="channelsManager" />
		</property>
		<property name="endpointClass">org.mobicents.media.core.endpoints.impl.Ds0Endpoint
		</property>
		<property name="startChannelID">125</property>
		<property name="initialSize">15</property>
		<property name="isALaw">true</property>
		<property name="dsp"><inject bean="DSP" /></property>
	</bean>
	-->
</deployment>
